{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "MongoDB.Driver": "Warning"
    }
  },
  "AllowedHosts": "*",
  "ConnectionStrings": {
    "MongoDB": "mongodb://mongo-analytics:27017",
    "Redis": "redis:6379"
  },
  "MongoDB": {
    "ConnectionString": "mongodb://mongo-analytics:27017",
    "DatabaseName": "AnalyticsDb",
    "AnalyticsEventsCollectionName": "analytics_events",
    "ConnectionTimeoutMs": 30000,
    "ServerSelectionTimeoutMs": 30000,
    "SocketTimeoutMs": 30000,
    "MaxPoolSize": 100,
    "MinPoolSize": 0,
    "RetryWrites": true,
    "RetryReads": true,
    "MaxIdleTimeMs": 300000,
    "HeartbeatIntervalMs": 10000
  },
  "RabbitMQ": {
    "HostName": "message-broker",
    "Port": 5672,
    "UserName": "admin",
    "Password": "admin123",
    "VirtualHost": "/",
    "ExchangeName": "domain_events",
    "AnalyticsQueueName": "analytics_events",
    "AnalyticsRoutingKey": "analytics.*",
    "EnableRetry": true,
    "RetryCount": 3,
    "RetryDelayMs": 1000,
    "RequeueOnError": true,
    "DeadLetterExchange": false,
    "DeadLetterQueueName": "dead_letter_queue"
  },
  "Elasticsearch": {
    "Url": "http://elasticsearch:9200",
    "DefaultIndex": "analytics-events",
    "Username": "",
    "Password": ""
  },
  "Keycloak": {
    "Authority": "http://localhost:8080/realms/ddd-realm",
    "Audience": "analytics-api",
    "RequireHttpsMetadata": false,
    "ValidateIssuer": true,
    "ValidateAudience": true,
    "ValidateLifetime": true,
    "ClockSkew": "00:05:00"
  },
  "Serilog": {
    "Using": [ "Serilog.Sinks.Console", "Serilog.Sinks.Elasticsearch" ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": { "Microsoft": "Warning", "System": "Warning" }
    },
    "Enrich": [ "FromLogContext", "WithMachineName", "WithThreadId" ],
    "Properties": { "Application": "AnalyticsApi", "Environment": "Development" },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "[{Timestamp:HH:mm:ss} {Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}"
        }
      },
      {
        "Name": "Elasticsearch",
        "Args": {
          "NodeUris": "http://elasticsearch:9200",
          "IndexFormat": "analytics-logs-{0:yyyy.MM.dd}",
          "TemplateName": "analytics-logs",
          "AutoRegisterTemplate": true,
          "AutoRegisterTemplateVersion": "ESv7",
          "NumberOfShards": 1,
          "NumberOfReplicas": 0,
          "DeadLetterIndexName": "deadletter-analytics-logs",
          "Period": 2,
          "BatchPostingLimit": 50,
          "ConnectionTimeout": 5,
          "EmitEventFailure": "WriteToSelfLog, RaiseCallback, ThrowException"
        }
      }
    ]
  }}
